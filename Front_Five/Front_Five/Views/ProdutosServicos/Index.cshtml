@model IEnumerable<FiveMotors.Models.Veiculo>

@{
    ViewData["Title"] = "Produtos e Serviços";
    Layout = "/Views/Shared/_Layout_Produtos.cshtml";
}

<div class="container my-5">
    <div class="row g-4">

        <!-- FILTROS -->
        <aside class="col-lg-3">
            <div class="card shadow-sm border-0 rounded-4 filtros-card">
                <div class="card-header bg-light border-0 rounded-top-4">
                    <h5 class="mb-0 fw-bold text-uppercase text-secondary">Filtros</h5>
                </div>
                <div class="card-body">
                    <form method="get" asp-action="Index" asp-controller="ProdutosServicos">

                        <div class="mb-3">
                            <label class="form-label text-uppercase text-muted">Modelo</label>
                            <input type="text" name="modelo" value="@Context.Request.Query["modelo"]"
                                   class="form-control rounded-3" placeholder="Digite o modelo..." />
                        </div>

                        <div class="mb-3">
                            <label class="form-label text-uppercase text-muted">Marca</label>
                            <select name="marca" class="form-select rounded-3">
                                <option value="">Todas</option>
                                @foreach (string m in (IEnumerable<string>)ViewBag.Marcas)
                                {
                                    <option value="@m" selected="@(Context.Request.Query["marca"] == m)">@m</option>
                                }
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label text-uppercase text-muted">Ano</label>
                            <select name="ano" class="form-select rounded-3">
                                <option value="">Todos</option>
                                @foreach (int a in (IEnumerable<int>)ViewBag.Anos)
                                {
                                    <option value="@a" selected="@(Context.Request.Query["ano"] == a.ToString())">@a</option>
                                }
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label text-uppercase text-muted">Faixa de Preço</label>
                            <select name="faixaPreco" class="form-select rounded-3">
                                <option value="">Todas</option>
                                <option value="ate50000" selected="@(Context.Request.Query["faixaPreco"] == "ate50000")">Até R$ 50.000</option>
                                <option value="50000a100000" selected="@(Context.Request.Query["faixaPreco"] == "50000a100000")">R$ 50.000 – R$ 100.000</option>
                                <option value="acima100000" selected="@(Context.Request.Query["faixaPreco"] == "acima100000")">Acima de R$ 100.000</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label text-uppercase text-muted">Estoque</label>
                            <select name="estoque" class="form-select rounded-3">
                                <option value="">Todos</option>
                                <option value="1" selected="@(Context.Request.Query["estoque"] == "1")">Disponível</option>
                                <option value="0" selected="@(Context.Request.Query["estoque"] == "0")">Indisponível</option>
                            </select>
                        </div>

                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-gradient w-50 rounded-3">Procurar</button>
                            <a asp-action="Index" asp-controller="ProdutosServicos" class="btn btn-outline-secondary w-50 rounded-3">Limpar</a>
                        </div>

                    </form>
                </div>
            </div>
        </aside>

        <!-- LISTAGEM -->
        <section class="col-lg-9">
            <div class="row g-4">

                @if (Model != null && Model.Any())
                {
                    foreach (var item in Model)
                    {
                        var imagens = item.ImagemsVeiculo?.ToList() ?? new List<string>();
                        var imagemFrente = imagens.Count > 1 ? imagens[1] : imagens.FirstOrDefault();
                        var imagemLateral = imagens.FirstOrDefault();

                        <div class="col-md-6 col-lg-4">
                            <div class="car-card float-hover">
                                <div class="card-inner">
                                    <div class="card-front">
                                        <img src="@imagemLateral" alt="@item.Modelo" />
                                    </div>
                                    <div class="card-back">
                                        <img src="@imagemFrente" alt="@item.Modelo" />
                                    </div>
                                </div>
                                <div class="car-info">
                                    <h5>@item.Marca @item.Modelo (@item.Ano)</h5>
                                    <p>@item.Descricao</p>
                                    <span class="price">R$ @item.Preco.ToString("N2")</span>
                                    <a asp-action="Especificacao" asp-route-id="@item.VeiculosId" class="btn btn-gradient rounded-3">Ver Detalhes</a>
                                </div>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="col-12">
                        <p class="text-center text-muted fs-5">Nenhum veículo encontrado.</p>
                    </div>
                }

            </div>
        </section>

    </div>
</div>

<style>
    /* Botão Gradient */
    .btn-gradient {
        background: linear-gradient(90deg, #EEEEEE, #888888);
        color: #fff;
        font-weight: 600;
        transition: 0.3s;
    }

        .btn-gradient:hover {
            transform: scale(1.05);
            opacity: 0.9;
        }

    /* Card do veículo */
    .car-card {
        background: #fff;
        border-radius: 16px;
        box-shadow: 0 6px 18px rgba(0,0,0,0.1);
        overflow: hidden;
        perspective: 1000px;
        transition: transform 0.3s ease;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

        .car-card:hover {
            transform: translateY(-6px);
        }

    .card-inner {
        position: relative;
        width: 100%;
        height: 220px;
        transform-style: preserve-3d;
        transition: transform 0.8s;
    }

    .car-card:hover .card-inner {
        transform: rotateY(180deg);
    }

    .card-front, .card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
    }

        .card-front img, .card-back img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 14px;
        }

    .card-back {
        transform: rotateY(180deg);
    }

    /* Informações do veículo */
    .car-info {
        padding: 15px;
        text-align: center;
    }

        .car-info h5 {
            font-weight: bold;
            color: #333;
        }

        .car-info p {
            font-size: 14px;
            color: #666;
            min-height: 40px;
        }

    .price {
        display: block;
        margin: 10px 0;
        color: #7C6868;
        font-weight: bold;
        font-size: 16px;
    }
</style>
