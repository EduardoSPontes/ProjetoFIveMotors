@model IEnumerable<FiveMotors.Models.Veiculo>

@{
    ViewData["Title"] = "Produtos e Serviços";
    Layout = "/Views/Shared/_Layout_Produtos.cshtml";
}

<!-- ========================= HEADER DA SEÇÃO ========================= -->
<div class="section-header text-center py-5">
    <h1 class="fw-bold title-main">Explore Nossos Veículos</h1>
    <p class="subtitle">
        Encontre o carro perfeito combinando desempenho, estilo e tecnologia.
    </p>
</div>


<div class="container mb-5">
    <div class="row g-4">

        <!-- ========================= FILTROS ========================= -->
        <aside class="col-lg-3">
            <div class="filter-box shadow-sm p-4 rounded-4">

                <h4 class="text-uppercase fw-bold mb-4 text-secondary">Filtros</h4>

                <form method="get" asp-action="Index" asp-controller="ProdutosServicos">

                    <div class="mb-3">
                        <label class="form-label fw-semibold">Modelo</label>
                        <input type="text"
                               name="modelo"
                               value="@Context.Request.Query["modelo"]"
                               class="form-control rounded-3"
                               placeholder="Digite o modelo..." />
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-semibold">Marca</label>
                        <select class="form-select rounded-3" name="marca">
                            <option value="">Todas</option>
                            @foreach (string m in (IEnumerable<string>)ViewBag.Marcas)
                            {
                                <option value="@m" selected="@(Context.Request.Query["marca"] == m)">@m</option>
                            }
                        </select>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-semibold">Ano</label>
                        <select class="form-select rounded-3" name="ano">
                            <option value="">Todos</option>
                            @foreach (int a in (IEnumerable<int>)ViewBag.Anos)
                            {
                                <option value="@a" selected="@(Context.Request.Query["ano"] == a.ToString())">@a</option>
                            }
                        </select>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-semibold">Preço</label>
                        <select class="form-select rounded-3" name="faixaPreco">
                            <option value="">Todas</option>
                            <option value="ate50000" selected="@(Context.Request.Query["faixaPreco"] == "ate50000")">Até R$ 50.000</option>
                            <option value="50000a100000" selected="@(Context.Request.Query["faixaPreco"] == "50000a100000")">R$ 50.000 – 100.000</option>
                            <option value="acima100000" selected="@(Context.Request.Query["faixaPreco"] == "acima100000")">Acima de R$ 100.000</option>
                        </select>
                    </div>

                    <div class="mb-4">
                        <label class="form-label fw-semibold">Estoque</label>
                        <select class="form-select rounded-3" name="estoque">
                            <option value="">Todos</option>
                            <option value="1" selected="@(Context.Request.Query["estoque"] == "1")">Disponível</option>
                            <option value="0" selected="@(Context.Request.Query["estoque"] == "0")">Indisponível</option>
                        </select>
                    </div>

                    <div class="d-flex gap-3">
                        <button class="btn btn-gradient w-50 rounded-3" type="submit">Buscar</button>
                        <a asp-action="Index" asp-controller="ProdutosServicos"
                           class="btn btn-outline-secondary w-50 rounded-3">Limpar</a>
                    </div>

                </form>
            </div>
        </aside>


        <!-- ========================= LISTA DE VEÍCULOS ========================= -->
        <section class="col-lg-9">
            <div class="row g-4">

                @if (Model != null && Model.Any())
                {
                    foreach (var item in Model)
                    {
                        var imagens = item.ImagemsVeiculo?.ToList() ?? new List<string>();
                        var imgFrente = imagens.Count > 1 ? imagens[1] : imagens.FirstOrDefault();
                        var imgLateral = imagens.FirstOrDefault();

                        <div class="col-md-6 col-lg-4">
                            <div class="car-card">

                                <!-- Flip -->
                                <div class="card-inner">
                                    <div class="card-front">
                                        <img src="@imgLateral" alt="@item.Modelo" />
                                    </div>

                                    <div class="card-back">
                                        <img src="@imgFrente" alt="@item.Modelo" />
                                    </div>
                                </div>

                                <!-- Info -->
                                <div class="car-info">
                                    <h5 class="fw-bold">@item.Marca @item.Modelo (@item.Ano)</h5>
                                    <p>@item.Descricao</p>
                                    <span class="price">R$ @item.Preco.ToString("N2")</span>

                                    <a asp-action="Especificacao"
                                       asp-route-id="@item.VeiculosId"
                                       class="btn btn-gradient w-100 rounded-3">
                                        Ver Detalhes
                                    </a>
                                </div>

                            </div>
                        </div>
                    }
                }
                else
                {
                    <p class="text-center fs-5 text-muted">Nenhum veículo encontrado.</p>
                }

            </div>
        </section>

    </div>
</div>


<!-- ========================= ESTILO ========================= -->
<style>
    /* Títulos */
    .title-main {
        font-size: 2.5rem;
        color: #1C2C3A;
    }

    .subtitle {
        max-width: 650px;
        margin: 0 auto;
        color: #666;
        font-size: 1.1rem;
    }



    /* Filtros */
    .filter-box {
        background: #fff;
        border-radius: 20px;
    }

    .form-label {
        font-size: 0.85rem;
        color: #495057;
    }



    /* Botão Gradiente */
    .btn-gradient {
        background: linear-gradient(90deg, #444, #999);
        color: white;
        font-weight: 600;
        transition: 0.3s;
    }

        .btn-gradient:hover {
            transform: scale(1.07);
            opacity: .9;
            color: white;
        }



    /* Card do carro */
    .car-card {
        background: white;
        border-radius: 18px;
        overflow: hidden;
        box-shadow: 0 8px 22px rgba(0,0,0,0.15);
        padding-bottom: 10px;
        transition: .4s ease;
    }

        .car-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 28px rgba(0,0,0,0.25);
        }


    /* Flip */
    .card-inner {
        position: relative;
        width: 100%;
        height: 220px;
        transform-style: preserve-3d;
        transition: transform 0.7s ease;
    }

    .car-card:hover .card-inner {
        transform: rotateY(180deg);
    }

    .card-front,
    .card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
    }

        .card-front img,
        .card-back img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 16px;
        }

    .card-back {
        transform: rotateY(180deg);
    }



    /* Informações */
    .car-info {
        padding: 15px;
        text-align: center;
    }

        .car-info p {
            min-height: 40px;
            font-size: 14px;
            color: #666;
        }

    .price {
        display: block;
        margin: 10px 0 15px;
        font-weight: bold;
        font-size: 18px;
        color: #7C6868;
    }
</style>
